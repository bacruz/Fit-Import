group = "com.krischik"
version = "1.0.0"
description = "Import KetFit and Withings exports into Google Fit â€” Android App"

buildscript {
   repositories {
      mavenCentral ()
   }
   dependencies {
      classpath (
         [group: 'com.android.tools.build', name: 'gradle', version: '1.0.0'],
         [group: 'com.neenbedankt.gradle.plugins', name: 'android-apt', version: '1.4'],
         [group: 'com.jakewharton.hugo', name: 'hugo-plugin', version: '1.2.1'],
         [group: 'org.jetbrains.kotlin', name: 'kotlin-gradle-plugin', version: kotlin_version]
      )
   }
}

apply plugin: 'com.android.application'
apply plugin: 'com.jakewharton.hugo'
apply plugin: 'android-apt'
apply plugin: 'kotlin-android'

repositories {
   mavenCentral ()
   mavenLocal ()
}

android {
   compileSdkVersion 21
   buildToolsVersion "20.0.0"

   applicationVariants.all { variant ->
      variant.outputs.each { output ->
         def name = output.outputFile.name
            .replace (".apk", "-${variant.versionName}.apk")
            .replace (project.name, "Fit-Import")

         output.outputFile = new File (output.outputFile.parent, name)
      }
   }

   signingConfigs {
      debug {
         storeFile file (System.getenv ("KEY_STORE"))
         storePassword System.getenv ("KEY_STOREPASS")
         keyAlias System.getenv ("KEY_ALIAS")
         keyPassword System.getenv ("KEY_KEYPASS")
      }
      release {
         storeFile file (System.getenv ("KEY_STORE"))
         storePassword System.getenv ("KEY_STOREPASS")
         keyAlias System.getenv ("KEY_ALIAS")
         keyPassword System.getenv ("KEY_KEYPASS")
      }
   }

   defaultConfig {
      applicationId "com.krischik.fit_import"
      minSdkVersion 15
      targetSdkVersion 21
      versionCode 10000
      versionName "1.0.0"
   }
   buildTypes {
      release {
         signingConfig signingConfigs.release
         minifyEnabled false
         proguardFiles getDefaultProguardFile ('proguard-android.txt'), 'proguard-rules.pro'
      }
   }
   sourceSets {
      main.java.srcDirs += 'src/main/kotlin'
   }
   compileOptions {
      sourceCompatibility JavaVersion.VERSION_1_7
      targetCompatibility JavaVersion.VERSION_1_7
   }
}

dependencies {
   apt (
      [group: 'org.androidannotations', name: 'androidannotations', version: androidannotations_version]
   )
   compile (
      project (':lib'),
      [group: 'com.android.support', name: 'appcompat-v7', version: androidsupport_version],
      [group: 'com.android.support', name: 'support-v4', version: androidsupport_version],
      [group: 'com.google.android.gms', name:'play-services', version:'6.1.+'],
      [group: 'org.androidannotations', name: 'androidannotations-api', version: androidannotations_version],
      [group: 'org.jetbrains.kotlin', name: 'kotlin-stdlib', version: kotlin_version]
   )
}

apt {
   arguments {
      androidManifestFile variant.outputs [0].processResources.manifestFile
      // if you have multiple outputs (when using splits), you may want to have other index than 0

      resourcePackageName 'com.krischik.fit_import'

      // If you're using Android NBS flavors you should use the following line instead of hard-coded packageName
      // resourcePackageName android.defaultConfig.packageName

      // You can set optional annotation processing options here, like these commented options:
      // logLevel 'INFO'
      // logFile '/var/log/aa.log'
   }
}
